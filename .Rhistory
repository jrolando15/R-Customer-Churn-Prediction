churn <- read.csv("~/Classes/ai 163/final project/churn")
View(churn)
churn_liu <- churn
N <- dim(churn_liu)[1]
churn_liu$index <- c(1:N)
View(churn_liu)
library(dplyr)
churn_liu<- select(churn_liu, -Phone)
set.seed(7)
n <-dim(churn_liu)[1]
train_ind <- runif(n) < .67
churn_train <- churn_liu[train_ind,]
churn_test <- churn_liu[!train_ind,]
to.resample <- which(churn_train$Churn == "True")
our.resample <- sample(x = to.resample, size = 175, replace =TRUE)
our.resample <- churn_train[our.resample, ]
train_churn_rebal <- rbind(churn_train, our.resample)
t.v1 <- table(train_churn_rebal$Churn)
t.v2 <- rbind( t.v1, round(prop.table(t.v1), 4))
colnames(t.v2) <- c("Churn = False", "Churn = True")
rownames(t.v2) <- c("Count" , "Proportion")
t.v2
to.resample_1 <- which(churn_test$Churn == "True")
our.resample_1 <- sample(x = to.resample_1, size = 63, replace = TRUE)
our.resample_1 <- churn_test[our.resample_1, ]
test_churn_rebal <- rbind(churn_test, our.resample_1)
t.v3 <- table(test_churn_rebal$Churn)
t.v4 <- rbind(t.v3, round(prop.table(t.v3), 4))
colnames(t.v4) <- c("Churn = False", "Churn =True")
rownames(t.v4) <- c("Count", "Proportion")
t.v4
install.packages(c("rpart", "rpart.plot"))
library(rpart)
library(rpart.plot)
churn_train$Churn <- as.factor(churn_train$Churn)
churn_test$Chur, <- as.factor(churn_test$Churn)
churn_test$Churn <- as.factor(churn_test$Churn)
churn_train$State <- as.factor(churn_train$State)
churn_test$State <- as.factor(churn_test$State)
churn_train$VMail.Plan <- as.factor(churn_train$VMail.Message)
churn_test$VMail.Plan <- as.factor(churn_test$VMail.Plan)
churn_train$VMail.Plan <- as.factor(churn_train$VMail.Plan)
cart_model_1 <- rpart(Churn ~ Day.Mins + CustServ.Calls, data = churn_train, method = "class")
rpart.plot(cart_model_1)
cart_model_test-1 <- rpart(Churn ~ Day.Mins + CustServ.Calls, data = churn_test, method = "class")
cart_model_test_1 <- rpart(Churn ~ Day.Mins + CustServ.Calls, data = churn_test, method = "class")
rpart.plot(cart_model_test_1)
cart_model_2 <- rpart(Churn ~ VMail.Plan + Day.Charge, data = churn_train, method = "class")
rpart.plot(cart_model_2)
cart_model_test_2 <- rpart(Churn ~ VMail.Plan + Day.Charge, data = churn_test, method = "class")
rpart.plot(cart_model_test_2)
cart_model_3 <- rpart(Churn ~ State + Day.Mins, data = churn_train, method = "class")
rpart.plot(cart_model_3)
cart_model_test_3 <- rpart(Churn ~ State + Day.Mins, data = churn_test, method = "class")
rpart.plot(cart_model_test_3)
C5 <- C5.0(formula = Churn ~ Day.Mins + CustServ.Calls, data = churn_train, control = C5.0Control(minCases = 100))
library(C50)
C5 <- C5.0(formula = Churn ~ Day.Mins + CustServ.Calls, data = churn_train, control = C5.0Control(minCases = 100))
plot(C5)
C6 <- C5.0(formula = Churn ~ Day.Mins + CustServ.Calls, data = churn_test, control = C5.0Control(minCases = 100))
plot(C6)
C7 <- C5.0(formula = Churn ~ VMail.Plan + Day.Charge, data = churn_train, control = C5.0Control(minCases = 100))
plot(C7)
C8 <- C5.0(formula = Churn ~ VMail.Plan + Day.Charge, data = churn_test, control = C5.0Control(minCases = 100))
plot(C8)
C9 <- C5.0(formula = Churn ~ State +  Day.Mins, data = churn_train, control = C5.0Control(minCases = 100))
plot(C9)
C10 <- C5.0(formula = Churn ~ State + Day.Mins, data = churn_test, control = C5.0Control(minCases = 100))
plot(C10)
library(party)
rf05 <- randomForest(formula = Churn ~ State + Day.Mins, data = churn_train, ntree = 100, type = "classification")
library(randomForest)
rf05 <- randomForest(formula = Churn ~ State + Day.Mins, data = churn_train, ntree = 100, type = "classification")
X_5 <- ctree(Churn ~ State + Day.Mins , data = churn_train)
plot(X_5, type = 'simple')
rf06 <- randomForest(formula = Churn ~ State + Day.Mins, data = churn_test, ntree = 100, type = "classification")
X_6 <- ctree(Churn ~ state + Day.Mins, data = churn_test)
X_6 <- ctree(Churn ~ State + Day.Mins, data = churn_test)
plot(X_6, type = "simple")
summary(rf06)
summary(rf05)
summary(C6)
summary(C7)
summary(C8)
summary(C10)
C6 <- C5.0(formula = Churn ~ Day.Mins + CustServ.Calls, data = churn_test, control = C5.0Control(minCases = 20))
plot(C6)
C8 <- C5.0(formula = Churn ~ VMail.Plan + Day.Charge, data = churn_test, control = C5.0Control(minCases = 20))
plot(C8)
C10<- C5.0(formula = Churn ~ State + Day.Mins, data = churn_test, control = C5.0Control(minCases = 20))
plot(C10)
churn_test$State <- as.factor(churn_test$State)
C10<- C5.0(formula = Churn ~ State + Day.Mins, data = churn_test, control = C5.0Control(minCases = 20))
plot(C10)
summary(C10)
C8 <- C5.0(formula = Churn ~ VMail.Plan + Day.Charge, data = churn_test, control = C5.0Control(minCases = 10))
plot(C8)
C8 <- C5.0(formula = Churn ~ VMail.Plan + Day.Charge, data = churn_test, control = C5.0Control(minCases = 50))
plot(C8)
plot(C10)
q()
